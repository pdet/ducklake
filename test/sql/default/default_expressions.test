# name: test/sql/default/default_expressions.test
# description: Test adding a column with default expression with DuckLake
# group: [default]

require ducklake

require parquet

test-env DUCKLAKE_CONNECTION __TEST_DIR__/{UUID}.db

test-env DATA_PATH __TEST_DIR__

statement ok
ATTACH 'ducklake:${DUCKLAKE_CONNECTION}' AS ducklake (DATA_PATH '${DATA_PATH}/default_expressions', METADATA_CATALOG 'xx')

statement ok
use ducklake

statement ok
create table t (id integer, created_at timestamp default now());

statement ok
insert into t(id) values(1);

query II
select * from t;
----