# name: test/sql/macros/macros.test
# description: test ducklake with macros
# group: [insert]

require ducklake

require parquet

test-env DUCKLAKE_CONNECTION __TEST_DIR__/{UUID}.db

statement ok
ATTACH 'ducklake:${DUCKLAKE_CONNECTION}' AS ducklake (DATA_PATH '__TEST_DIR__/macros')

statement ok
USE ducklake

statement ok
CREATE MACRO one() AS (SELECT 1);