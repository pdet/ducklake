# name: test/sql/ducklake_basic.test
# description: test ducklake extension
# group: [sql]

require ducklake

require parquet

statement ok
ATTACH 'ducklake:__TEST_DIR__/ducklake.db' AS ducklake (DATA_PATH '__TEST_DIR__/ducklake_files', METADATA_CATALOG 'ducklake_meta')

statement ok
USE ducklake;

statement ok
CREATE TABLE t1(c1 int);


statement ok
BEGIN;

statement ok
INSERT INTO t1 VALUES (1), (2);

statement ok
UPDATE t1 SET c1 = 3 WHERE c1 = 1;

statement ok
DELETE FROM t1 WHERE c1 = 2;

query I
FROM t1;
----
3